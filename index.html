<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Pedidos</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/vanilla-masker@1.1.1/lib/vanilla-masker.js"></script>
</head>
<body>
    <h2>Pedido do Cliente</h2>
    <form id="pedidoForm">
        <!-- ... resto do formulário permanece igual ... -->
    </form>

    <!-- Botão de teste -->
    <button type="button" onclick="testarImpressora()" style="margin-top: 10px; background-color: #007bff;">
        Testar Impressora
    </button>

    <script>
        // Função para imprimir usando diferentes interfaces do RawBT
        function printRawBT(texto) {
            try {
                // Tenta diferentes métodos de impressão
                if (typeof RawBT !== 'undefined') {
                    RawBT.print(texto);
                    return true;
                } else if (typeof window.RawBT !== 'undefined') {
                    window.RawBT.print(texto);
                    return true;
                } else if (typeof window.Android !== 'undefined') {
                    window.Android.printText(texto);
                    return true;
                } else if (typeof Android !== 'undefined') {
                    Android.printText(texto);
                    return true;
                }
                
                alert('Interface de impressão não encontrada.\n\nPor favor, verifique:\n1. Se você está usando o app RawBT\n2. Se a impressora está conectada no app');
                return false;
            } catch (e) {
                alert('Erro ao imprimir: ' + e.message);
                return false;
            }
        }

        // Função de teste simples
        function testarImpressora() {
            console.log('Tentando imprimir teste...');
            const textoTeste = "=== TESTE DE IMPRESSAO ===\n\nFuncionando!\n\n\n";
            if (printRawBT(textoTeste)) {
                alert('Comando de impressão enviado!');
            }
        }

        // Função principal de impressão
        function imprimirPedido() {
            const nome = document.getElementById('nome').value;
            const telefone = document.getElementById('telefone').value;
            const produtos = document.getElementById('produtos').value;
            const pagamento = document.getElementById('pagamento').value;
            const endereco = document.getElementById('endereco').value;
            const valor = document.getElementById('valor').value;

            const texto = 
                "===== PEDIDO =====\n" +
                "Cliente: " + nome + "\n" +
                "Telefone: " + telefone + "\n" +
                "Produtos: " + produtos + "\n" +
                "Pagamento: " + pagamento + "\n" +
                "Endereco: " + endereco + "\n" +
                "Valor: " + valor + "\n" +
                "================\n\n\n";

            if (printRawBT(texto)) {
                alert('Pedido enviado para impressão!');
            }
        }

        // Máscaras
        window.onload = function() {
            var telefoneInput = document.getElementById('telefone');
            VMasker(telefoneInput).maskPattern('(99) 99999-9999');

            var valorInput = document.getElementById('valor');
            VMasker(valorInput).maskMoney({
                precision: 2,
                separator: ',',
                delimiter: '.',
                unit: 'R$ '
            });

            // Verifica interfaces disponíveis
            console.log('RawBT disponível:', typeof RawBT !== 'undefined');
            console.log('window.RawBT disponível:', typeof window.RawBT !== 'undefined');
            console.log('Android disponível:', typeof Android !== 'undefined');
            console.log('window.Android disponível:', typeof window.Android !== 'undefined');
        }
    </script>
</body>
</html>
